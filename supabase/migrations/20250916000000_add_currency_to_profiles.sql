-- Add currency fields to profiles table
ALTER TABLE profiles 
ADD COLUMN currency_code VARCHAR(3) DEFAULT 'USD',
ADD COLUMN currency_symbol VARCHAR(10) DEFAULT '$';

-- Update existing records with currency based on country
UPDATE profiles 
SET 
  currency_code = CASE 
    WHEN country = 'Nigeria' THEN 'NGN'
    WHEN country = 'South Africa' THEN 'ZAR'
    WHEN country = 'Kenya' THEN 'KES'
    WHEN country = 'Ghana' THEN 'GHS'
    WHEN country = 'Egypt' THEN 'EGP'
    WHEN country = 'Morocco' THEN 'MAD'
    WHEN country = 'Tunisia' THEN 'TND'
    WHEN country = 'Algeria' THEN 'DZD'
    WHEN country = 'Ethiopia' THEN 'ETB'
    WHEN country = 'Uganda' THEN 'UGX'
    WHEN country = 'Tanzania' THEN 'TZS'
    WHEN country = 'Rwanda' THEN 'RWF'
    WHEN country = 'Senegal' THEN 'XOF'
    WHEN country = 'Ivory Coast' THEN 'XOF'
    WHEN country = 'Mali' THEN 'XOF'
    WHEN country = 'Burkina Faso' THEN 'XOF'
    WHEN country = 'Niger' THEN 'XOF'
    WHEN country = 'Guinea' THEN 'GNF'
    WHEN country = 'Sierra Leone' THEN 'SLL'
    WHEN country = 'Liberia' THEN 'LRD'
    WHEN country = 'Cameroon' THEN 'XAF'
    WHEN country = 'Central African Republic' THEN 'XAF'
    WHEN country = 'Chad' THEN 'XAF'
    WHEN country = 'Congo' THEN 'XAF'
    WHEN country = 'Equatorial Guinea' THEN 'XAF'
    WHEN country = 'Gabon' THEN 'XAF'
    WHEN country = 'Angola' THEN 'AOA'
    WHEN country = 'Mozambique' THEN 'MZN'
    WHEN country = 'Zambia' THEN 'ZMW'
    WHEN country = 'Zimbabwe' THEN 'ZWL'
    WHEN country = 'Botswana' THEN 'BWP'
    WHEN country = 'Namibia' THEN 'NAD'
    WHEN country = 'Lesotho' THEN 'LSL'
    WHEN country = 'Swaziland' THEN 'SZL'
    WHEN country = 'Madagascar' THEN 'MGA'
    WHEN country = 'Mauritius' THEN 'MUR'
    WHEN country = 'Seychelles' THEN 'SCR'
    WHEN country = 'Comoros' THEN 'KMF'
    WHEN country = 'Djibouti' THEN 'DJF'
    WHEN country = 'Eritrea' THEN 'ERN'
    WHEN country = 'Somalia' THEN 'SOS'
    WHEN country = 'Sudan' THEN 'SDG'
    WHEN country = 'South Sudan' THEN 'SSP'
    WHEN country = 'Libya' THEN 'LYD'
    WHEN country = 'Mauritania' THEN 'MRU'
    WHEN country = 'Cape Verde' THEN 'CVE'
    WHEN country = 'São Tomé and Príncipe' THEN 'STN'
    WHEN country = 'Guinea-Bissau' THEN 'XOF'
    WHEN country = 'Gambia' THEN 'GMD'
    WHEN country = 'Benin' THEN 'XOF'
    WHEN country = 'Togo' THEN 'XOF'
    WHEN country = 'United States' THEN 'USD'
    WHEN country = 'Canada' THEN 'CAD'
    WHEN country = 'Mexico' THEN 'MXN'
    WHEN country = 'Guatemala' THEN 'GTQ'
    WHEN country = 'Honduras' THEN 'HNL'
    WHEN country = 'El Salvador' THEN 'USD'
    WHEN country = 'Nicaragua' THEN 'NIO'
    WHEN country = 'Costa Rica' THEN 'CRC'
    WHEN country = 'Panama' THEN 'PAB'
    WHEN country = 'Cuba' THEN 'CUP'
    WHEN country = 'Jamaica' THEN 'JMD'
    WHEN country = 'Haiti' THEN 'HTG'
    WHEN country = 'Dominican Republic' THEN 'DOP'
    WHEN country = 'Puerto Rico' THEN 'USD'
    WHEN country = 'Trinidad and Tobago' THEN 'TTD'
    WHEN country = 'Barbados' THEN 'BBD'
    WHEN country = 'Bahamas' THEN 'BSD'
    WHEN country = 'Belize' THEN 'BZD'
    WHEN country = 'Brazil' THEN 'BRL'
    WHEN country = 'Argentina' THEN 'ARS'
    WHEN country = 'Chile' THEN 'CLP'
    WHEN country = 'Colombia' THEN 'COP'
    WHEN country = 'Peru' THEN 'PEN'
    WHEN country = 'Venezuela' THEN 'VES'
    WHEN country = 'Ecuador' THEN 'USD'
    WHEN country = 'Bolivia' THEN 'BOB'
    WHEN country = 'Paraguay' THEN 'PYG'
    WHEN country = 'Uruguay' THEN 'UYU'
    WHEN country = 'Guyana' THEN 'GYD'
    WHEN country = 'Suriname' THEN 'SRD'
    WHEN country = 'French Guiana' THEN 'EUR'
    WHEN country = 'United Kingdom' THEN 'GBP'
    WHEN country = 'Germany' THEN 'EUR'
    WHEN country = 'France' THEN 'EUR'
    WHEN country = 'Italy' THEN 'EUR'
    WHEN country = 'Spain' THEN 'EUR'
    WHEN country = 'Netherlands' THEN 'EUR'
    WHEN country = 'Belgium' THEN 'EUR'
    WHEN country = 'Austria' THEN 'EUR'
    WHEN country = 'Switzerland' THEN 'CHF'
    WHEN country = 'Sweden' THEN 'SEK'
    WHEN country = 'Norway' THEN 'NOK'
    WHEN country = 'Denmark' THEN 'DKK'
    WHEN country = 'Finland' THEN 'EUR'
    WHEN country = 'Poland' THEN 'PLN'
    WHEN country = 'Czech Republic' THEN 'CZK'
    WHEN country = 'Hungary' THEN 'HUF'
    WHEN country = 'Romania' THEN 'RON'
    WHEN country = 'Bulgaria' THEN 'BGN'
    WHEN country = 'Croatia' THEN 'EUR'
    WHEN country = 'Slovenia' THEN 'EUR'
    WHEN country = 'Slovakia' THEN 'EUR'
    WHEN country = 'Estonia' THEN 'EUR'
    WHEN country = 'Latvia' THEN 'EUR'
    WHEN country = 'Lithuania' THEN 'EUR'
    WHEN country = 'Ireland' THEN 'EUR'
    WHEN country = 'Portugal' THEN 'EUR'
    WHEN country = 'Greece' THEN 'EUR'
    WHEN country = 'Cyprus' THEN 'EUR'
    WHEN country = 'Malta' THEN 'EUR'
    WHEN country = 'Luxembourg' THEN 'EUR'
    WHEN country = 'Iceland' THEN 'ISK'
    WHEN country = 'Russia' THEN 'RUB'
    WHEN country = 'Ukraine' THEN 'UAH'
    WHEN country = 'Belarus' THEN 'BYN'
    WHEN country = 'Moldova' THEN 'MDL'
    WHEN country = 'Albania' THEN 'ALL'
    WHEN country = 'North Macedonia' THEN 'MKD'
    WHEN country = 'Serbia' THEN 'RSD'
    WHEN country = 'Montenegro' THEN 'EUR'
    WHEN country = 'Bosnia and Herzegovina' THEN 'BAM'
    WHEN country = 'Kosovo' THEN 'EUR'
    WHEN country = 'China' THEN 'CNY'
    WHEN country = 'Japan' THEN 'JPY'
    WHEN country = 'South Korea' THEN 'KRW'
    WHEN country = 'India' THEN 'INR'
    WHEN country = 'Indonesia' THEN 'IDR'
    WHEN country = 'Thailand' THEN 'THB'
    WHEN country = 'Vietnam' THEN 'VND'
    WHEN country = 'Philippines' THEN 'PHP'
    WHEN country = 'Malaysia' THEN 'MYR'
    WHEN country = 'Singapore' THEN 'SGD'
    WHEN country = 'Hong Kong' THEN 'HKD'
    WHEN country = 'Taiwan' THEN 'TWD'
    WHEN country = 'Pakistan' THEN 'PKR'
    WHEN country = 'Bangladesh' THEN 'BDT'
    WHEN country = 'Sri Lanka' THEN 'LKR'
    WHEN country = 'Nepal' THEN 'NPR'
    WHEN country = 'Bhutan' THEN 'BTN'
    WHEN country = 'Maldives' THEN 'MVR'
    WHEN country = 'Myanmar' THEN 'MMK'
    WHEN country = 'Cambodia' THEN 'KHR'
    WHEN country = 'Laos' THEN 'LAK'
    WHEN country = 'Brunei' THEN 'BND'
    WHEN country = 'Mongolia' THEN 'MNT'
    WHEN country = 'Kazakhstan' THEN 'KZT'
    WHEN country = 'Uzbekistan' THEN 'UZS'
    WHEN country = 'Kyrgyzstan' THEN 'KGS'
    WHEN country = 'Tajikistan' THEN 'TJS'
    WHEN country = 'Turkmenistan' THEN 'TMT'
    WHEN country = 'Afghanistan' THEN 'AFN'
    WHEN country = 'Iran' THEN 'IRR'
    WHEN country = 'Iraq' THEN 'IQD'
    WHEN country = 'Syria' THEN 'SYP'
    WHEN country = 'Lebanon' THEN 'LBP'
    WHEN country = 'Jordan' THEN 'JOD'
    WHEN country = 'Israel' THEN 'ILS'
    WHEN country = 'Palestine' THEN 'ILS'
    WHEN country = 'Saudi Arabia' THEN 'SAR'
    WHEN country = 'United Arab Emirates' THEN 'AED'
    WHEN country = 'Qatar' THEN 'QAR'
    WHEN country = 'Kuwait' THEN 'KWD'
    WHEN country = 'Bahrain' THEN 'BHD'
    WHEN country = 'Oman' THEN 'OMR'
    WHEN country = 'Yemen' THEN 'YER'
    WHEN country = 'Australia' THEN 'AUD'
    WHEN country = 'New Zealand' THEN 'NZD'
    WHEN country = 'Fiji' THEN 'FJD'
    WHEN country = 'Papua New Guinea' THEN 'PGK'
    WHEN country = 'Solomon Islands' THEN 'SBD'
    WHEN country = 'Vanuatu' THEN 'VUV'
    WHEN country = 'Samoa' THEN 'WST'
    WHEN country = 'Tonga' THEN 'TOP'
    WHEN country = 'Kiribati' THEN 'AUD'
    WHEN country = 'Tuvalu' THEN 'AUD'
    WHEN country = 'Nauru' THEN 'AUD'
    WHEN country = 'Palau' THEN 'USD'
    WHEN country = 'Marshall Islands' THEN 'USD'
    WHEN country = 'Micronesia' THEN 'USD'
    WHEN country = 'Cook Islands' THEN 'NZD'
    WHEN country = 'Niue' THEN 'NZD'
    WHEN country = 'Tokelau' THEN 'NZD'
    WHEN country = 'French Polynesia' THEN 'XPF'
    WHEN country = 'New Caledonia' THEN 'XPF'
    WHEN country = 'Wallis and Futuna' THEN 'XPF'
    ELSE 'USD'
  END,
  currency_symbol = CASE 
    WHEN country = 'Nigeria' THEN '₦'
    WHEN country = 'South Africa' THEN 'R'
    WHEN country = 'Kenya' THEN 'KSh'
    WHEN country = 'Ghana' THEN '₵'
    WHEN country = 'Egypt' THEN '£'
    WHEN country = 'Morocco' THEN 'د.م.'
    WHEN country = 'Tunisia' THEN 'د.ت'
    WHEN country = 'Algeria' THEN 'د.ج'
    WHEN country = 'Ethiopia' THEN 'Br'
    WHEN country = 'Uganda' THEN 'USh'
    WHEN country = 'Tanzania' THEN 'TSh'
    WHEN country = 'Rwanda' THEN 'RF'
    WHEN country = 'Senegal' THEN 'CFA'
    WHEN country = 'Ivory Coast' THEN 'CFA'
    WHEN country = 'Mali' THEN 'CFA'
    WHEN country = 'Burkina Faso' THEN 'CFA'
    WHEN country = 'Niger' THEN 'CFA'
    WHEN country = 'Guinea' THEN 'FG'
    WHEN country = 'Sierra Leone' THEN 'Le'
    WHEN country = 'Liberia' THEN 'L$'
    WHEN country = 'Cameroon' THEN 'FCFA'
    WHEN country = 'Central African Republic' THEN 'FCFA'
    WHEN country = 'Chad' THEN 'FCFA'
    WHEN country = 'Congo' THEN 'FCFA'
    WHEN country = 'Equatorial Guinea' THEN 'FCFA'
    WHEN country = 'Gabon' THEN 'FCFA'
    WHEN country = 'Angola' THEN 'Kz'
    WHEN country = 'Mozambique' THEN 'MT'
    WHEN country = 'Zambia' THEN 'ZK'
    WHEN country = 'Zimbabwe' THEN 'Z$'
    WHEN country = 'Botswana' THEN 'P'
    WHEN country = 'Namibia' THEN 'N$'
    WHEN country = 'Lesotho' THEN 'L'
    WHEN country = 'Swaziland' THEN 'E'
    WHEN country = 'Madagascar' THEN 'Ar'
    WHEN country = 'Mauritius' THEN '₨'
    WHEN country = 'Seychelles' THEN '₨'
    WHEN country = 'Comoros' THEN 'CF'
    WHEN country = 'Djibouti' THEN 'Fdj'
    WHEN country = 'Eritrea' THEN 'Nfk'
    WHEN country = 'Somalia' THEN 'S'
    WHEN country = 'Sudan' THEN 'ج.س.'
    WHEN country = 'South Sudan' THEN '£'
    WHEN country = 'Libya' THEN 'ل.د'
    WHEN country = 'Mauritania' THEN 'UM'
    WHEN country = 'Cape Verde' THEN '$'
    WHEN country = 'São Tomé and Príncipe' THEN 'Db'
    WHEN country = 'Guinea-Bissau' THEN 'CFA'
    WHEN country = 'Gambia' THEN 'D'
    WHEN country = 'Benin' THEN 'CFA'
    WHEN country = 'Togo' THEN 'CFA'
    WHEN country = 'United States' THEN '$'
    WHEN country = 'Canada' THEN 'C$'
    WHEN country = 'Mexico' THEN '$'
    WHEN country = 'Guatemala' THEN 'Q'
    WHEN country = 'Honduras' THEN 'L'
    WHEN country = 'El Salvador' THEN '$'
    WHEN country = 'Nicaragua' THEN 'C$'
    WHEN country = 'Costa Rica' THEN '₡'
    WHEN country = 'Panama' THEN 'B/.'
    WHEN country = 'Cuba' THEN '$'
    WHEN country = 'Jamaica' THEN 'J$'
    WHEN country = 'Haiti' THEN 'G'
    WHEN country = 'Dominican Republic' THEN 'RD$'
    WHEN country = 'Puerto Rico' THEN '$'
    WHEN country = 'Trinidad and Tobago' THEN 'TT$'
    WHEN country = 'Barbados' THEN 'Bds$'
    WHEN country = 'Bahamas' THEN 'B$'
    WHEN country = 'Belize' THEN 'BZ$'
    WHEN country = 'Brazil' THEN 'R$'
    WHEN country = 'Argentina' THEN '$'
    WHEN country = 'Chile' THEN '$'
    WHEN country = 'Colombia' THEN '$'
    WHEN country = 'Peru' THEN 'S/'
    WHEN country = 'Venezuela' THEN 'Bs.S'
    WHEN country = 'Ecuador' THEN '$'
    WHEN country = 'Bolivia' THEN 'Bs'
    WHEN country = 'Paraguay' THEN '₲'
    WHEN country = 'Uruguay' THEN '$U'
    WHEN country = 'Guyana' THEN 'G$'
    WHEN country = 'Suriname' THEN '$'
    WHEN country = 'French Guiana' THEN '€'
    WHEN country = 'United Kingdom' THEN '£'
    WHEN country = 'Germany' THEN '€'
    WHEN country = 'France' THEN '€'
    WHEN country = 'Italy' THEN '€'
    WHEN country = 'Spain' THEN '€'
    WHEN country = 'Netherlands' THEN '€'
    WHEN country = 'Belgium' THEN '€'
    WHEN country = 'Austria' THEN '€'
    WHEN country = 'Switzerland' THEN 'CHF'
    WHEN country = 'Sweden' THEN 'kr'
    WHEN country = 'Norway' THEN 'kr'
    WHEN country = 'Denmark' THEN 'kr'
    WHEN country = 'Finland' THEN '€'
    WHEN country = 'Poland' THEN 'zł'
    WHEN country = 'Czech Republic' THEN 'Kč'
    WHEN country = 'Hungary' THEN 'Ft'
    WHEN country = 'Romania' THEN 'lei'
    WHEN country = 'Bulgaria' THEN 'лв'
    WHEN country = 'Croatia' THEN '€'
    WHEN country = 'Slovenia' THEN '€'
    WHEN country = 'Slovakia' THEN '€'
    WHEN country = 'Estonia' THEN '€'
    WHEN country = 'Latvia' THEN '€'
    WHEN country = 'Lithuania' THEN '€'
    WHEN country = 'Ireland' THEN '€'
    WHEN country = 'Portugal' THEN '€'
    WHEN country = 'Greece' THEN '€'
    WHEN country = 'Cyprus' THEN '€'
    WHEN country = 'Malta' THEN '€'
    WHEN country = 'Luxembourg' THEN '€'
    WHEN country = 'Iceland' THEN 'kr'
    WHEN country = 'Russia' THEN '₽'
    WHEN country = 'Ukraine' THEN '₴'
    WHEN country = 'Belarus' THEN 'Br'
    WHEN country = 'Moldova' THEN 'L'
    WHEN country = 'Albania' THEN 'L'
    WHEN country = 'North Macedonia' THEN 'ден'
    WHEN country = 'Serbia' THEN 'дин'
    WHEN country = 'Montenegro' THEN '€'
    WHEN country = 'Bosnia and Herzegovina' THEN 'КМ'
    WHEN country = 'Kosovo' THEN '€'
    WHEN country = 'China' THEN '¥'
    WHEN country = 'Japan' THEN '¥'
    WHEN country = 'South Korea' THEN '₩'
    WHEN country = 'India' THEN '₹'
    WHEN country = 'Indonesia' THEN 'Rp'
    WHEN country = 'Thailand' THEN '฿'
    WHEN country = 'Vietnam' THEN '₫'
    WHEN country = 'Philippines' THEN '₱'
    WHEN country = 'Malaysia' THEN 'RM'
    WHEN country = 'Singapore' THEN 'S$'
    WHEN country = 'Hong Kong' THEN 'HK$'
    WHEN country = 'Taiwan' THEN 'NT$'
    WHEN country = 'Pakistan' THEN '₨'
    WHEN country = 'Bangladesh' THEN '৳'
    WHEN country = 'Sri Lanka' THEN '₨'
    WHEN country = 'Nepal' THEN '₨'
    WHEN country = 'Bhutan' THEN 'Nu.'
    WHEN country = 'Maldives' THEN 'Rf'
    WHEN country = 'Myanmar' THEN 'K'
    WHEN country = 'Cambodia' THEN '៛'
    WHEN country = 'Laos' THEN '₭'
    WHEN country = 'Brunei' THEN 'B$'
    WHEN country = 'Mongolia' THEN '₮'
    WHEN country = 'Kazakhstan' THEN '₸'
    WHEN country = 'Uzbekistan' THEN 'лв'
    WHEN country = 'Kyrgyzstan' THEN 'лв'
    WHEN country = 'Tajikistan' THEN 'SM'
    WHEN country = 'Turkmenistan' THEN 'T'
    WHEN country = 'Afghanistan' THEN '؋'
    WHEN country = 'Iran' THEN '﷼'
    WHEN country = 'Iraq' THEN 'د.ع'
    WHEN country = 'Syria' THEN '£'
    WHEN country = 'Lebanon' THEN 'ل.ل'
    WHEN country = 'Jordan' THEN 'د.ا'
    WHEN country = 'Israel' THEN '₪'
    WHEN country = 'Palestine' THEN '₪'
    WHEN country = 'Saudi Arabia' THEN '﷼'
    WHEN country = 'United Arab Emirates' THEN 'د.إ'
    WHEN country = 'Qatar' THEN '﷼'
    WHEN country = 'Kuwait' THEN 'د.ك'
    WHEN country = 'Bahrain' THEN 'د.ب'
    WHEN country = 'Oman' THEN '﷼'
    WHEN country = 'Yemen' THEN '﷼'
    WHEN country = 'Australia' THEN 'A$'
    WHEN country = 'New Zealand' THEN 'NZ$'
    WHEN country = 'Fiji' THEN 'FJ$'
    WHEN country = 'Papua New Guinea' THEN 'K'
    WHEN country = 'Solomon Islands' THEN 'SI$'
    WHEN country = 'Vanuatu' THEN 'Vt'
    WHEN country = 'Samoa' THEN 'WS$'
    WHEN country = 'Tonga' THEN 'T$'
    WHEN country = 'Kiribati' THEN 'A$'
    WHEN country = 'Tuvalu' THEN 'A$'
    WHEN country = 'Nauru' THEN 'A$'
    WHEN country = 'Palau' THEN '$'
    WHEN country = 'Marshall Islands' THEN '$'
    WHEN country = 'Micronesia' THEN '$'
    WHEN country = 'Cook Islands' THEN 'NZ$'
    WHEN country = 'Niue' THEN 'NZ$'
    WHEN country = 'Tokelau' THEN 'NZ$'
    WHEN country = 'French Polynesia' THEN '₣'
    WHEN country = 'New Caledonia' THEN '₣'
    WHEN country = 'Wallis and Futuna' THEN '₣'
    ELSE '$'
  END;

-- Add comment to the new columns
COMMENT ON COLUMN profiles.currency_code IS 'ISO 4217 currency code based on country';
COMMENT ON COLUMN profiles.currency_symbol IS 'Currency symbol for display purposes';
